# Прогнозирование движений на криптовалютном рынке

Проект по предсказанию краткосрочных ценовых движений на криптовалютном рынке с использованием машинного обучения. В рамках задачи использовались как открытые рыночные данные, так и специальные индикаторы торговой компании DRW.

---

## Этапы работы

**Технологии:** Python, Pandas, Scikit-learn, XGBoost, NumPy, Matplotlib, Seaborn

### 1. **Загрузка и анализ данных**
   - Работа с большим объемом данных: 525,886 тренировочных и 538,150 тестовых записей
   - Изучение структуры 786 признаков в каждом наборе
   - Проверка качества данных, отсутствия пропусков и выбросов

### 2. **Исследовательский анализ данных (EDA)**
   - Визуализация распределений ключевых рыночных показателей
   - Анализ корреляций между различными признаками
   - Исследование выбросов через диаграммы "ящик с усами"
   - Создание тепловых карт для наглядного представления взаимосвязей

### 3. **Создание новых признаков**
   На основе понимания рыночной микроструктуры создала 3 осмысленных признака:
   - **bid_vs_ask**: соотношение объемов на покупку и продажу
   - **buy_vs_sell**: соотношение совершенных покупок и продаж
   - **pressure**: чистый объемный дисбаланс - направление рыночного давления

### 4. **Отбор и фильтрация признаков**
   - Анализ 780 специальных индикаторов компании DRW (X1...X780)
   - Удаление сильно коррелирующих признаков (корреляция > 0.8) для уменьшения избыточности
   - Отбор топ-50 признаков по абсолютной корреляции с целевой переменной
   - Итоговый набор: 58 признаков (5 исходных + 3 новых + 50 отобранных)

### 5. **Моделирование**
   - Реализация TimeSeries Cross-Validation (5 фолдов) для корректной работы с временными рядами
   - Сравнение различных алгоритмов машинного обучения
   - Выбор и оптимизация XGBoost как наиболее подходящей модели
   - Получение стабильных результатов на кросс-валидации

### 6. **Финальное обучение и прогнозы**
   - Обучение оптимизированной модели XGBoost на 500,000 строках данных
   - Настройка гиперпараметров для баланса между точностью и устойчивостью
   - Создание предсказаний для всего тестового набора данных
   - Сохранение и анализ результатов

---

## Особенности проекта

### **Работа с финансовыми временными рядами:**
- Использование TimeSeries Cross-Validation вместо стандартного разбиения
- Учет временной структуры данных при валидации модели
- Анализ устойчивости модели на различных временных промежутках

### **Работа с закрытыми индикаторами:**
- Анализ 780 специальных признаков, разработанных компанией DRW
- Эти индикаторы являются частью торговой стратегии компании и представлены в анонимном виде
- Эффективный отбор наиболее информативных признаков из большого набора

### **Балансировка сложности модели:**
```python
XGBRegressor(
    n_estimators=300,      # Оптимальное количество деревьев
    learning_rate=0.02,    # Медленное обучение для лучшей сходимости
    max_depth=5,           # Предотвращение переобучения
    reg_alpha=0.1,         # Регуляризация для отбора признаков
    reg_lambda=1,          # Регуляризация для устойчивости
)
